<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="ÊäïË≥áÂàÜÊûêÂ∑•ÂÖ∑">
    <title>ÂÄã‰∫∫ÊäïË≥áÂàÜÊûêÂ∑•ÂÖ∑ v2.0</title>
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='80' font-size='80'>üìä</text></svg>">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
        }
        
        h1 {
            text-align: center;
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 2.2em;
            font-weight: 300;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .version-badge {
            display: inline-block;
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .section {
            margin-bottom: 25px;
            border: 1px solid #e2e8f0;
            border-radius: 15px;
            padding: 20px;
            background: white;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        
        .section h2 {
            color: #4a5568;
            margin-bottom: 15px;
            border-bottom: 3px solid #e2e8f0;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.3em;
        }
        
        .input-group {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }
        
        label {
            font-weight: 600;
            color: #374151;
            font-size: 14px;
        }
        
        input, select {
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .industry-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .industry-card {
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
        }
        
        .industry-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.15);
        }
        
        .industry-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .industry-card h3 {
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .industry-card p {
            font-size: 12px;
            margin-bottom: 5px;
        }
        
        .module-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .module {
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 15px;
            background: linear-gradient(135deg, #fff, #f8fafc);
            position: relative;
            overflow: hidden;
        }
        
        .module::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(135deg, #667eea, #764ba2);
        }
        
        .module h3 {
            color: #4a5568;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 16px;
        }
        
        .weight-badge {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
        }
        
        .score-display {
            text-align: center;
            margin: 10px 0;
        }
        
        .score-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
            color: white;
            margin: 8px;
        }
        
        .score-excellent { background: linear-gradient(135deg, #28a745, #20c997); }
        .score-good { background: linear-gradient(135deg, #17a2b8, #6f42c1); }
        .score-average { background: linear-gradient(135deg, #ffc107, #fd7e14); }
        .score-poor { background: linear-gradient(135deg, #dc3545, #e83e8c); }
        
        .indicator-list h4 {
            font-size: 14px;
            color: #4a5568;
            margin: 10px 0 5px 0;
        }
        
        .indicator-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 6px;
            margin: 4px 0;
            background: #f8f9fa;
            border-radius: 6px;
            font-size: 13px;
        }
        
        .indicator-item span {
            flex: 1;
            margin-right: 8px;
        }
        
        .indicator-item input {
            width: 70px;
            padding: 4px;
            font-size: 12px;
        }
        
        .total-score {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 15px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }
        
        .total-score h2 {
            font-size: 3em;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }
        
        .recommendation {
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: 600;
            text-align: center;
        }
        
        .rec-buy { background: linear-gradient(135deg, #d4edda, #c3e6cb); color: #155724; }
        .rec-hold { background: linear-gradient(135deg, #fff3cd, #ffeaa7); color: #856404; }
        .rec-sell { background: linear-gradient(135deg, #f8d7da, #f5c6cb); color: #721c24; }
        
        .valuation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .valuation-card {
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        .pessimistic { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .neutral { background: linear-gradient(135deg, #6b7280, #4b5563); }
        .optimistic { background: linear-gradient(135deg, #10b981, #059669); }
        
        .action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }
        
        button {
            padding: 12px 20px;
            border: none;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        
        .btn-primary { background: linear-gradient(135deg, #667eea, #764ba2); color: white; }
        .btn-secondary { background: linear-gradient(135deg, #6b7280, #4b5563); color: white; }
        .btn-success { background: linear-gradient(135deg, #10b981, #059669); color: white; }
        .btn-warning { background: linear-gradient(135deg, #f59e0b, #d97706); color: white; }
        
        .alert {
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            font-weight: 500;
        }
        
        .alert-success { background: linear-gradient(135deg, #d4edda, #c3e6cb); color: #155724; border: 1px solid #c3e6cb; }
        .alert-warning { background: linear-gradient(135deg, #fff3cd, #ffeaa7); color: #856404; border: 1px solid #ffeaa7; }
        .alert-danger { background: linear-gradient(135deg, #f8d7da, #f5c6cb); color: #721c24; border: 1px solid #f5c6cb; }
        
        @media (max-width: 768px) {
            .container { padding: 15px; }
            h1 { font-size: 1.8em; }
            .input-group { grid-template-columns: 1fr; gap: 8px; }
            .industry-selector { grid-template-columns: 1fr; }
            .module-grid { grid-template-columns: 1fr; }
            .valuation-grid { grid-template-columns: 1fr; }
            .action-buttons { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä ÂÄã‰∫∫ÊäïË≥áÂàÜÊûêÂ∑•ÂÖ∑ <span class="version-badge">v2.0</span></h1>
        
        <div class="section">
            <h2>üè¢ Âü∫Êú¨Ë≥áË®ä</h2>
            <div class="input-group">
                <label>‰∫§ÊòìÊâÄ:</label>
                <select id="exchange">
                    <option value="us">ÁæéËÇ° (US)</option>
                    <option value="tw">Âè∞ËÇ° (TW)</option>
                    <option value="hk">Ê∏ØËÇ° (HK)</option>
                    <option value="other">ÂÖ∂‰ªñ</option>
                </select>
                <span></span>
            </div>
            <div class="input-group">
                <label>ËÇ°Á•®‰ª£Á¢º:</label>
                <input type="text" id="stockCode" placeholder="Â¶Ç: AAPL, 2330, 00878">
                <span></span>
            </div>
            <div class="input-group">
                <label>Áï∂ÂâçËÇ°ÂÉπ:</label>
                <input type="number" id="currentPrice" placeholder="Ëº∏ÂÖ•Áï∂ÂâçËÇ°ÂÉπ" step="0.01">
                <span id="currencyDisplay">USD</span>
            </div>
            <div class="input-group">
                <label>Â∏ÇÂÄº:</label>
                <input type="number" id="marketCap" placeholder="Ëº∏ÂÖ•Â∏ÇÂÄº" step="0.1">
                <span id="marketCapDisplay">ÂÑÑUSD</span>
            </div>
        </div>
        
        <div class="section">
            <h2>üè≠ Áî¢Ê•≠È°ûÂà•ÈÅ∏Êìá</h2>
            <div class="industry-selector">
                <div class="industry-card" data-industry="tech">
                    <h3>üíª ÁßëÊäÄÊàêÈï∑Âûã</h3>
                    <p>ËªüÈ´î„ÄÅÂçäÂ∞éÈ´î„ÄÅÈõªÂïÜ</p>
                </div>
                <div class="industry-card" data-industry="cyclical">
                    <h3>üîÑ ÈÄ±ÊúüÂûã</h3>
                    <p>ÈãºÈêµ„ÄÅÂåñÂ∑•„ÄÅËà™ÈÅã</p>
                </div>
                <div class="industry-card" data-industry="defensive">
                    <h3>üõ°Ô∏è Èò≤Á¶¶Âûã</h3>
                    <p>ÂÖ¨Áî®‰∫ãÊ•≠„ÄÅÈ£üÂìÅ„ÄÅÈõª‰ø°</p>
                </div>
                <div class="industry-card" data-industry="financial">
                    <h3>üè¶ ÈáëËûçÂûã</h3>
                    <p>ÈäÄË°å„ÄÅ‰øùÈö™„ÄÅË≠âÂà∏</p>
                </div>
                <div class="industry-card" data-industry="capital">
                    <h3>üèóÔ∏è Ë≥áÊú¨ÂØÜÈõÜÂûã</h3>
                    <p>ÊàøÂú∞Áî¢„ÄÅÂü∫Âª∫„ÄÅËÉΩÊ∫ê</p>
                </div>
                <div class="industry-card" data-industry="consumer">
                    <h3>üõçÔ∏è Ê∂àË≤ªÂûã</h3>
                    <p>Èõ∂ÂîÆ„ÄÅÈ§êÈ£≤„ÄÅÂ•¢‰æàÂìÅ</p>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>üìà Ë©ïÂàÜÊ®°ÁµÑ</h2>
            <div class="module-grid" id="moduleGrid">
                <p style="text-align: center; color: #6b7280; padding: 40px;">Ë´ãÂÖàÈÅ∏ÊìáÁî¢Ê•≠È°ûÂà•‰ª•È°ØÁ§∫Ë©ïÂàÜÊ®°ÁµÑ</p>
            </div>
        </div>
        
        <div class="total-score">
            <h2 id="totalScore">--</h2>
            <p>Á∏ΩË©ïÂàÜ</p>
            <div class="recommendation" id="recommendation">Ë´ãÂÖàÂÆåÊàêÊâÄÊúâË©ï‰º∞</div>
        </div>
        
        <div class="section">
            <h2>üí∞ ‰∏âÊÉÖÂ¢É‰º∞ÂÄºÊ®°Âûã</h2>
            <div class="valuation-grid">
                <div class="valuation-card pessimistic">
                    <h3>ÊÇ≤ËßÄÊÉÖÂ¢É</h3>
                    <p id="pessimisticPrice">--</p>
                    <small id="pessimisticAssumption">--</small>
                </div>
                <div class="valuation-card neutral">
                    <h3>‰∏≠Á´ãÊÉÖÂ¢É</h3>
                    <p id="neutralPrice">--</p>
                    <small id="neutralAssumption">--</small>
                </div>
                <div class="valuation-card optimistic">
                    <h3>Ê®ÇËßÄÊÉÖÂ¢É</h3>
                    <p id="optimisticPrice">--</p>
                    <small id="optimisticAssumption">--</small>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>üéØ Êìç‰ΩúÂª∫Ë≠∞</h2>
            <div id="actionSuggestions">
                <p>Ë´ãÂÆåÊàêË©ïÂàÜÂæåÊü•ÁúãÊìç‰ΩúÂª∫Ë≠∞</p>
            </div>
        </div>
        
        <div class="action-buttons">
            <button class="btn-primary" onclick="calculateAnalysis()">üöÄ ÈñãÂßãÂàÜÊûê</button>
            <button class="btn-secondary" onclick="exportReport()">üìä Â∞éÂá∫Â†±Âëä</button>
            <button class="btn-success" onclick="saveData()">üíæ ‰øùÂ≠òÊï∏Êìö</button>
            <button class="btn-warning" onclick="resetAll()">üîÑ ÈáçË®≠ÊâÄÊúâ</button>
        </div>
        
        <div class="section">
            <h2>üì± ÊâãÊ©ü‰ΩøÁî®ÊåáÂçó</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                <div style="padding: 15px; background: linear-gradient(135deg, #ecfdf5, #d1fae5); border-radius: 10px;">
                    <h4>üçé iPhone Áî®Êà∂</h4>
                    <ol style="margin: 10px 0; padding-left: 20px;">
                        <li>Áî® Safari ÈñãÂïüÊ≠§È†ÅÈù¢</li>
                        <li>ÈªûÊìäÂ∫ïÈÉ®„ÄåÂàÜ‰∫´„ÄçÊåâÈàï</li>
                        <li>ÈÅ∏Êìá„ÄåÂä†ÂÖ•‰∏ªÁï´Èù¢„Äç</li>
                        <li>Ë®≠ÂÆöÂêçÁ®±ÂæåÁ¢∫Ë™ç</li>
                    </ol>
                </div>
                <div style="padding: 15px; background: linear-gradient(135deg, #fef3c7, #fcd34d); border-radius: 10px;">
                    <h4>ü§ñ Android Áî®Êà∂</h4>
                    <ol style="margin: 10px 0; padding-left: 20px;">
                        <li>Áî® Chrome ÈñãÂïüÊ≠§È†ÅÈù¢</li>
                        <li>ÈªûÊìäÂè≥‰∏äËßí„Äå‚ãÆ„ÄçÈÅ∏ÂñÆ</li>
                        <li>ÈÅ∏Êìá„ÄåÂä†Âà∞‰∏ªÁï´Èù¢„Äç</li>
                        <li>Á¢∫Ë™çÊ∑ªÂä†</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const industryConfigs = {
            tech: {
                name: 'ÁßëÊäÄÊàêÈï∑Âûã',
                modules: {
                    growth: { weight: 40, name: 'ÊàêÈï∑ÊÄß', indicators: ['ÁáüÊî∂ÊàêÈï∑Áéá', 'Á†îÁôºË≤ªÁî®ÊØî', 'Êñ∞Áî¢ÂìÅÁáüÊî∂Âç†ÊØî', 'Áî®Êà∂Â¢ûÈï∑Áéá'] },
                    profitability: { weight: 30, name: 'ÁõàÂà©ËÉΩÂäõ', indicators: ['ÊØõÂà©Áéá', 'ROE', 'ROA', 'Ê∑®Âà©Áéá'] },
                    valuation: { weight: 20, name: '‰º∞ÂÄº', indicators: ['PEG', 'P/S', 'EV/Revenue'] },
                    health: { weight: 10, name: 'Ë≤°ÂãôÂÅ•Â∫∑', indicators: ['ÁèæÈáëÊØî', 'Ë≤†ÂÇµÁéá', 'ÊµÅÂãïÊØîÁéá'] }
                },
                valuation: {
                    pessimistic: { desc: 'P/E=15x, Âà©Áéá‰∏äÂçá+Á´∂Áà≠Âä†Âäá' },
                    neutral: { desc: 'P/E=25x, Á©©ÂÆöÊàêÈï∑ËªåÈÅì' },
                    optimistic: { desc: 'P/E=40x, AIÈù©ÂëΩÊÄßÁ™ÅÁ†¥' }
                }
            },
            cyclical: {
                name: 'ÈÄ±ÊúüÂûã',
                modules: {
                    health: { weight: 40, name: 'Ë≤°ÂãôÂÅ•Â∫∑', indicators: ['Ë≤†ÂÇµÁéá', 'ÁèæÈáëÊØî', 'ÁáüÈÅãÁèæÈáëÊµÅ', 'Ê∑®ÁèæÈáëÊØîÁéá'] },
                    valuation: { weight: 30, name: '‰º∞ÂÄº', indicators: ['P/B', 'EV/EBITDA', 'ÈÄ±ÊúüË™øÊï¥P/E'] },
                    profitability: { weight: 20, name: 'ÁõàÂà©ËÉΩÂäõ', indicators: ['ROEÈÄ±ÊúüÊÄß', 'ÊØõÂà©ÁéáÁ©©ÂÆöÊÄß'] },
                    growth: { weight: 10, name: 'ÊàêÈï∑ÊÄß', indicators: ['Áî¢ËÉΩÊì¥Âºµ', 'Â∏ÇÂç†ÁéáËÆäÂåñ'] }
                },
                valuation: {
                    pessimistic: { desc: 'P/B=0.8x, ÈÄ±ÊúüÂ∫ïÈÉ®' },
                    neutral: { desc: 'P/B=1.2x, ÈÄ±Êúü‰∏≠ÊÆµ' },
                    optimistic: { desc: 'P/B=1.8x, ÈÄ±ÊúüÈ´òÈªû' }
                }
            },
            defensive: {
                name: 'Èò≤Á¶¶Âûã',
                modules: {
                    profitability: { weight: 35, name: 'ÁõàÂà©ËÉΩÂäõ', indicators: ['ROEÁ©©ÂÆöÊÄß', 'ËÇ°ÊÅØÁéá', 'Ê∑®Âà©Áéá'] },
                    health: { weight: 30, name: 'Ë≤°ÂãôÂÅ•Â∫∑', indicators: ['Ë≤†ÂÇµÁéá', 'Âà©ÊÅØË¶ÜËìã', 'ÊµÅÂãïÊØîÁéá'] },
                    valuation: { weight: 25, name: '‰º∞ÂÄº', indicators: ['ËÇ°ÊÅØÊÆñÂà©Áéá', 'P/E', 'Beta‰øÇÊï∏'] },
                    growth: { weight: 10, name: 'ÊàêÈï∑ÊÄß', indicators: ['ÁáüÊî∂Á©©ÂÆöÊÄß', 'Â∏ÇÂç†Áéá'] }
                },
                valuation: {
                    pessimistic: { desc: 'ËÇ°ÊÅØÊÆñÂà©Áéá=6%' },
                    neutral: { desc: 'ËÇ°ÊÅØÊÆñÂà©Áéá=4.5%' },
                    optimistic: { desc: 'ËÇ°ÊÅØÊÆñÂà©Áéá=3.5%' }
                }
            },
            financial: {
                name: 'ÈáëËûçÂûã',
                modules: {
                    health: { weight: 35, name: 'Ë≤°ÂãôÂÅ•Â∫∑', indicators: ['Ë≥áÊú¨ÈÅ©Ë∂≥Áéá', 'ÈÄæÊîæÊØî', 'ÂÇôÊäµË¶ÜËìãÁéá'] },
                    profitability: { weight: 35, name: 'ÁõàÂà©ËÉΩÂäõ', indicators: ['ROE', 'Ê∑®Âà©Â∑Æ', 'ÊàêÊú¨Êî∂ÂÖ•ÊØî'] },
                    valuation: { weight: 20, name: '‰º∞ÂÄº', indicators: ['P/B', 'Êú¨ÁõäÊØî', 'ËÇ°ÂÉπÊ∑®ÂÄºÊØî'] },
                    growth: { weight: 10, name: 'ÊàêÈï∑ÊÄß', indicators: ['ÊîæÊ¨æÊàêÈï∑', 'Â≠òÊ¨æÊàêÈï∑'] }
                },
                valuation: {
                    pessimistic: { desc: 'P/B=0.7x, Âà©Â∑ÆÂ£ìÁ∏Æ' },
                    neutral: { desc: 'P/B=1.0x, Á©©ÂÆöÁ∂ìÁáü' },
                    optimistic: { desc: 'P/B=1.4x, Âà©Áéá‰∏äÂçáÂèóÁõä' }
                }
            },
            capital: {
                name: 'Ë≥áÊú¨ÂØÜÈõÜÂûã',
                modules: {
                    health: { weight: 35, name: 'Ë≤°ÂãôÂÅ•Â∫∑', indicators: ['Ë≤†ÂÇµÁéá', 'Âà©ÊÅØË¶ÜËìã', 'ÁáüÈÅãÁèæÈáëÊµÅ'] },
                    valuation: { weight: 30, name: '‰º∞ÂÄº', indicators: ['P/B', 'EV/EBITDA', 'NAVÊäòÂÉπ'] },
                    profitability: { weight: 25, name: 'ÁõàÂà©ËÉΩÂäõ', indicators: ['ROIC', 'Ë≥áÁî¢Âë®ËΩâÁéá'] },
                    growth: { weight: 10, name: 'ÊàêÈï∑ÊÄß', indicators: ['Ë≥áÁî¢Êì¥Âºµ', 'ÁßüÈáëÊàêÈï∑'] }
                },
                valuation: {
                    pessimistic: { desc: 'P/B=0.8x, Ë≥áÁî¢Ê∏õÂÄºÈ¢®Èö™' },
                    neutral: { desc: 'P/B=1.2x, Á©©ÂÆöÁ∂ìÁáü' },
                    optimistic: { desc: 'P/B=1.6x, Ë≥áÁî¢Èáç‰º∞' }
                }
            },
            consumer: {
                name: 'Ê∂àË≤ªÂûã',
                modules: {
                    growth: { weight: 35, name: 'ÊàêÈï∑ÊÄß', indicators: ['ÂêåÂ∫óÊàêÈï∑Áéá', 'Êñ∞ÂìÅÊàêÂäüÁéá', 'ÈÄöË∑ØÊì¥Âºµ'] },
                    profitability: { weight: 30, name: 'ÁõàÂà©ËÉΩÂäõ', indicators: ['ÊØõÂà©Áéá', 'ROE', 'ÂìÅÁâåÊ∫¢ÂÉπ'] },
                    valuation: { weight: 25, name: '‰º∞ÂÄº', indicators: ['P/E', 'EV/EBITDA'] },
                    health: { weight: 10, name: 'Ë≤°ÂãôÂÅ•Â∫∑', indicators: ['ÁèæÈáëÊµÅ', 'Ë≤†ÂÇµÁéá'] }
                },
                valuation: {
                    pessimistic: { desc: 'P/E=15x, Ê∂àË≤ªËêéÁ∏Æ' },
                    neutral: { desc: 'P/E=22x, Á©©ÂÅ•ÊàêÈï∑' },
                    optimistic: { desc: 'P/E=30x, Ê∂àË≤ªÂçáÁ¥ö' }
                }
            }
        };
        
        let selectedIndustry = null, selectedExchange = 'us', moduleScores = {};
        
        document.addEventListener('DOMContentLoaded', () => updateCurrencyDisplay());
        document.getElementById('exchange').addEventListener('change', function() {
            selectedExchange = this.value;
            updateCurrencyDisplay();
        });
        
        function updateCurrencyDisplay() {
            const currencies = { us: 'USD', tw: 'TWD', hk: 'HKD', other: 'USD' };
            const currency = currencies[selectedExchange];
            document.getElementById('currencyDisplay').textContent = currency;
            document.getElementById('marketCapDisplay').textContent = `ÂÑÑ${currency}`;
        }
        
        document.querySelectorAll('.industry-card').forEach(card => {
            card.addEventListener('click', function() {
                document.querySelectorAll('.industry-card').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                selectedIndustry = this.dataset.industry;
                generateModules();
            });
        });
        
        function generateModules() {
            if (!selectedIndustry) return;
            const config = industryConfigs[selectedIndustry];
            const moduleGrid = document.getElementById('moduleGrid');
            moduleGrid.innerHTML = '';
            moduleScores = {};
            
            Object.keys(config.modules).forEach(moduleId => {
                const module = config.modules[moduleId];
                const moduleDiv = document.createElement('div');
                moduleDiv.className = 'module';
                moduleDiv.innerHTML = `
                    <h3>${module.name}<span class="weight-badge">${module.weight}%</span></h3>
                    <div class="score-display">
                        <div class="score-circle score-average" id="score-${moduleId}">--</div>
                    </div>
                    <div class="indicator-list">
                        <h4>ÈóúÈçµÊåáÊ®ô:</h4>
                        ${module.indicators.map(indicator => `
                            <div class="indicator-item">
                                <span>${indicator}:</span>
                                <input type="number" placeholder="0-100" min="0" max="100" 
                                       onchange="updateModuleScore('${moduleId}')" data-indicator="${indicator}">
                            </div>
                        `).join('')}
                    </div>
                `;
                moduleGrid.appendChild(moduleDiv);
            });
        }
        
        function updateModuleScore(moduleId) {
            const moduleDiv = document.querySelector(`#score-${moduleId}`).closest('.module');
            const inputs = moduleDiv.querySelectorAll('input[type="number"]');
            let total = 0, count = 0;
            
            inputs.forEach(input => {
                if (input.value && input.value !== '') {
                    total += parseFloat(input.value);
                    count++;
                }
            });
            
            if (count > 0) {
                const average = total / count;
                moduleScores[moduleId] = average;
                const scoreCircle = document.getElementById(`score-${moduleId}`);
                scoreCircle.textContent = Math.round(average);
                scoreCircle.className = 'score-circle ' + getScoreClass(average);
            } else {
                delete moduleScores[moduleId];
                const scoreCircle = document.getElementById(`score-${moduleId}`);
                scoreCircle.textContent = '--';
                scoreCircle.className = 'score-circle score-average';
            }
            calculateTotalScore();
        }
        
        function getScoreClass(score) {
            if (score >= 80) return 'score-excellent';
            if (score >= 70) return 'score-good';
            if (score >= 50) return 'score-average';
            return 'score-poor';
        }
        
        function calculateTotalScore() {
            if (!selectedIndustry || Object.keys(moduleScores).length === 0) {
                document.getElementById('totalScore').textContent = '--';
                document.getElementById('recommendation').textContent = 'Ë´ãÂÖàÂÆåÊàêÊâÄÊúâË©ï‰º∞';
                document.getElementById('recommendation').className = 'recommendation';
                return;
            }
            
            const config = industryConfigs[selectedIndustry];
            let weightedSum = 0, totalWeight = 0;
            
            Object.keys(moduleScores).forEach(moduleId => {
                const weight = config.modules[moduleId].weight;
                weightedSum += moduleScores[moduleId] * weight;
                totalWeight += weight;
            });
            
            const totalScore = Math.round(weightedSum / totalWeight);
            document.getElementById('totalScore').textContent = totalScore;
            updateRecommendation(totalScore);
            updateValuation(totalScore);
        }
        
        function updateRecommendation(score) {
            const recElement = document.getElementById('recommendation');
            if (score >= 80) {
                recElement.textContent = 'üöÄ Âº∑ÁÉàË≤∑ÂÖ• - ÂÑ™Ë≥™Ê®ôÁöÑÔºåÂª∫Ë≠∞Á©çÊ•µÈÖçÁΩÆ';
                recElement.className = 'recommendation rec-buy';
            } else if (score >= 70) {
                recElement.textContent = 'üìà Ë≤∑ÂÖ• - Âü∫Êú¨Èù¢ËâØÂ•ΩÔºåÂèØ‰ª•ËÄÉÊÖÆÊäïË≥á';
                recElement.className = 'recommendation rec-buy';
            } else if (score >= 50) {
                recElement.textContent = 'ü§î ÊåÅÊúâ - ‰∏≠ÊÄßË©ïÂÉπÔºåÂª∫Ë≠∞ËßÄÊúõ';
                recElement.className = 'recommendation rec-hold';
            } else if (score >= 30) {
                recElement.textContent = '‚ö†Ô∏è Ê∏õÊåÅ - È¢®Èö™ÂÅèÈ´òÔºåÂª∫Ë≠∞Ë¨πÊÖé';
                recElement.className = 'recommendation rec-sell';
            } else {
                recElement.textContent = '‚ùå Ë≥£Âá∫ - Âü∫Êú¨Èù¢ËºÉÂ∑ÆÔºåÂª∫Ë≠∞ÂõûÈÅø';
                recElement.className = 'recommendation rec-sell';
            }
        }
        
        function updateValuation(score) {
            const currentPrice = parseFloat(document.getElementById('currentPrice').value) || 0;
            if (!currentPrice || !selectedIndustry) return;
            
            const config = industryConfigs[selectedIndustry];
            const adjustment = (score - 50) / 100;
            const baseMultipliers = { pessimistic: 0.8, neutral: 1.0, optimistic: 1.3 };
            
            Object.keys(baseMultipliers).forEach(scenario => {
                const multiplier = baseMultipliers[scenario] * (1 + adjustment);
                const estimatedPrice = currentPrice * multiplier;
                document.getElementById(`${scenario}Price`).textContent = `${estimatedPrice.toFixed(2)}`;
                document.getElementById(`${scenario}Assumption`).textContent = config.valuation[scenario].desc;
            });
        }
        
        function calculateAnalysis() {
            if (!selectedIndustry) return showAlert('Ë´ãÂÖàÈÅ∏ÊìáÁî¢Ê•≠È°ûÂà•', 'warning');
            const stockCode = document.getElementById('stockCode').value;
            const currentPrice = document.getElementById('currentPrice').value;
            if (!stockCode || !currentPrice) return showAlert('Ë´ãÂ°´ÂØ´ËÇ°Á•®‰ª£Á¢ºÂíåÁï∂ÂâçËÇ°ÂÉπ', 'warning');
            if (Object.keys(moduleScores).length === 0) return showAlert('Ë´ãÂÖàÁÇ∫ÂêÑÈ†ÖÊåáÊ®ôË©ïÂàÜ', 'warning');
            
            calculateTotalScore();
            generateActionSuggestions();
            showAlert('ÂàÜÊûêÂÆåÊàêÔºÅ', 'success');
        }
        
        function generateActionSuggestions() {
            const totalScore = parseInt(document.getElementById('totalScore').textContent);
            const suggestionsDiv = document.getElementById('actionSuggestions');
            if (isNaN(totalScore)) return suggestionsDiv.innerHTML = '<p>Ë´ãÂÆåÊàêË©ïÂàÜÂæåÊü•ÁúãÊìç‰ΩúÂª∫Ë≠∞</p>';
            
            let suggestions = '';
            if (totalScore >= 80) {
                suggestions = `<div class="alert alert-success"><h4>üíé ÂÑ™Ë≥™ÊäïË≥áÊ®ôÁöÑ</h4><ul><li>Âª∫Ë≠∞ÂàÜÊâπÂª∫ÂÄâÔºåÁõÆÊ®ôÈÖçÁΩÆ 15-20%</li><li>ÂèØËÄÉÊÖÆÈÄ¢‰ΩéÂä†Á¢ºÊ©üÊúÉ</li><li>Ë®≠ÂÆöÊ≠¢ÁõàÈªûÔºöÁï∂ÂâçÂÉπÊ†º +30%</li><li>Ë®≠ÂÆöÊ≠¢ÊêçÈªûÔºöÁï∂ÂâçÂÉπÊ†º -15%</li></ul></div>`;
            } else if (totalScore >= 70) {
                suggestions = `<div class="alert alert-success"><h4>üìà ÂÄºÂæóÊäïË≥áÊ®ôÁöÑ</h4><ul><li>Âª∫Ë≠∞ÈÅ©Â∫¶ÈÖçÁΩÆÔºåÁõÆÊ®ôÈÖçÁΩÆ 10-15%</li><li>ÂØÜÂàáÈóúÊ≥®Âü∫Êú¨Èù¢ËÆäÂåñ</li><li>Ë®≠ÂÆöÊ≠¢ÁõàÈªûÔºöÁï∂ÂâçÂÉπÊ†º +25%</li><li>Ë®≠ÂÆöÊ≠¢ÊêçÈªûÔºöÁï∂ÂâçÂÉπÊ†º -12%</li></ul></div>`;
            } else if (totalScore >= 50) {
                suggestions = `<div class="alert alert-warning"><h4>ü§î ‰∏≠ÊÄßËßÄÊúõÊ®ôÁöÑ</h4><ul><li>Âª∫Ë≠∞Â∞èÂÄâ‰ΩçË©¶Êé¢ÔºåÈÖçÁΩÆ‰∏çË∂ÖÈÅé 5%</li><li>Á≠âÂæÖÊõ¥Â•ΩÁöÑÈÄ≤Â†¥ÊôÇÊ©ü</li><li>ÂØÜÂàáÈóúÊ≥®Áî¢Ê•≠ÂãïÂêë</li><li>Ë®≠ÂÆöËºÉÁ∑äÁöÑÊ≠¢ÊêçÔºöÁï∂ÂâçÂÉπÊ†º -8%</li></ul></div>`;
            } else {
                suggestions = `<div class="alert alert-danger"><h4>‚ö†Ô∏è È´òÈ¢®Èö™Ê®ôÁöÑ</h4><ul><li>Âª∫Ë≠∞ÂõûÈÅøÊàñÊ∏õÊåÅ</li><li>Â¶ÇÂ∑≤ÊåÅÊúâÔºåËÄÉÊÖÆÂàÜÊâπÂá∫Â†¥</li><li>Á≠âÂæÖÂü∫Êú¨Èù¢ÊòéÈ°ØÊîπÂñÑ</li><li>Ë®≠ÂÆöÂö¥Ê†ºÊ≠¢ÊêçÔºöÁï∂ÂâçÂÉπÊ†º -5%</li></ul></div>`;
            }
            suggestionsDiv.innerHTML = suggestions;
        }
        
        function exportReport() {
            if (!selectedIndustry || Object.keys(moduleScores).length === 0) return showAlert('Ë´ãÂÖàÂÆåÊàêÂàÜÊûê', 'warning');
            
            const stockCode = document.getElementById('stockCode').value || 'Êú™Â°´ÂØ´';
            const currentPrice = document.getElementById('currentPrice').value || 'Êú™Â°´ÂØ´';
            const totalScore = document.getElementById('totalScore').textContent;
            const recommendation = document.getElementById('recommendation').textContent;
            
            const report = `ÊäïË≥áÂàÜÊûêÂ†±Âëä\n=================\nËÇ°Á•®‰ª£Á¢º: ${stockCode}\nÁï∂ÂâçËÇ°ÂÉπ: ${currentPrice}\nÁî¢Ê•≠È°ûÂà•: ${industryConfigs[selectedIndustry].name}\nÂàÜÊûêÊó•Êúü: ${new Date().toLocaleDateString('zh-TW')}\n\nË©ïÂàÜÁµêÊûú:\n${Object.keys(moduleScores).map(moduleId => {
                const moduleName = industryConfigs[selectedIndustry].modules[moduleId].name;
                const score = moduleScores[moduleId];
                return `${moduleName}: ${Math.round(score)}ÂàÜ`;
            }).join('\n')}\n\nÁ∏ΩË©ïÂàÜ: ${totalScore}ÂàÜ\nÊäïË≥áÂª∫Ë≠∞: ${recommendation}\n\n‰º∞ÂÄºÂçÄÈñì:\nÊÇ≤ËßÄÊÉÖÂ¢É: ${document.getElementById('pessimisticPrice').textContent}\n‰∏≠Á´ãÊÉÖÂ¢É: ${document.getElementById('neutralPrice').textContent}\nÊ®ÇËßÄÊÉÖÂ¢É: ${document.getElementById('optimisticPrice').textContent}\n\nÂ†±ÂëäÁîüÊàêÊôÇÈñì: ${new Date().toLocaleString('zh-TW')}`;
            
            const blob = new Blob([report], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ÊäïË≥áÂàÜÊûêÂ†±Âëä_${stockCode}_${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            showAlert('Â†±ÂëäÂ∑≤Â∞éÂá∫ÔºÅ', 'success');
        }
        
        function saveData() {
            const data = {
                exchange: selectedExchange,
                stockCode: document.getElementById('stockCode').value,
                currentPrice: document.getElementById('currentPrice').value,
                marketCap: document.getElementById('marketCap').value,
                selectedIndustry: selectedIndustry,
                moduleScores: moduleScores,
                savedAt: new Date().toISOString()
            };
            
            try {
                const dataStr = JSON.stringify(data);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `ÊäïË≥áÂàÜÊûêÊï∏Êìö_${data.stockCode || 'unknown'}_${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);
                showAlert('Êï∏ÊìöÂ∑≤‰øùÂ≠òÔºÅ', 'success');
            } catch (error) {
                showAlert('‰øùÂ≠òÂ§±ÊïóÔºö' + error.message, 'danger');
            }
        }
        
        function resetAll() {
            if (confirm('Á¢∫ÂÆöË¶ÅÈáçË®≠ÊâÄÊúâÊï∏ÊìöÂóéÔºüÊ≠§Êìç‰ΩúÁÑ°Ê≥ïÂæ©Âéü„ÄÇ')) {
                document.getElementById('exchange').value = 'us';
                document.getElementById('stockCode').value = '';
                document.getElementById('currentPrice').value = '';
                document.getElementById('marketCap').value = '';
                document.querySelectorAll('.industry-card').forEach(c => c.classList.remove('selected'));
                selectedIndustry = null;
                moduleScores = {};
                document.getElementById('moduleGrid').innerHTML = '<p style="text-align: center; color: #6b7280; padding: 40px;">Ë´ãÂÖàÈÅ∏ÊìáÁî¢Ê•≠È°ûÂà•‰ª•È°ØÁ§∫Ë©ïÂàÜÊ®°ÁµÑ</p>';
                document.getElementById('totalScore').textContent = '--';
                document.getElementById('recommendation').textContent = 'Ë´ãÂÖàÂÆåÊàêÊâÄÊúâË©ï‰º∞';
                document.getElementById('recommendation').className = 'recommendation';
                ['pessimistic', 'neutral', 'optimistic'].forEach(scenario => {
                    document.getElementById(`${scenario}Price`).textContent = '--';
                    document.getElementById(`${scenario}Assumption`).textContent = '--';
                });
                document.getElementById('actionSuggestions').innerHTML = '<p>Ë´ãÂÆåÊàêË©ïÂàÜÂæåÊü•ÁúãÊìç‰ΩúÂª∫Ë≠∞</p>';
                updateCurrencyDisplay();
                showAlert('Â∑≤ÈáçË®≠ÊâÄÊúâÊï∏Êìö', 'success');
            }
        }
        
        function showAlert(message, type = 'success') {
            const existingAlert = document.querySelector('.temp-alert');
            if (existingAlert) existingAlert.remove();
            
            const alert = document.createElement('div');
            alert.className = `alert alert-${type} temp-alert`;
            alert.style.cssText = 'position: fixed; top: 20px; right: 20px; z-index: 9999; min-width: 300px; box-shadow: 0 10px 30px rgba(0,0,0,0.3);';
            alert.textContent = message;
            document.body.appendChild(alert);
            
            setTimeout(() => { if (alert.parentNode) alert.remove(); }, 3000);
        }
        
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 's': e.preventDefault(); saveData(); break;
                    case 'r': if (e.shiftKey) { e.preventDefault(); resetAll(); } break;
                    case 'Enter': e.preventDefault(); calculateAnalysis(); break;
                }
            }
        });
        
        function validateInputs() {
            const stockCode = document.getElementById('stockCode').value;
            const currentPrice = document.getElementById('currentPrice').value;
            
            if (stockCode && !/^[A-Za-z0-9.]+$/.test(stockCode)) {
                showAlert('ËÇ°Á•®‰ª£Á¢ºÊ†ºÂºè‰∏çÊ≠£Á¢∫', 'warning');
                return false;
            }
            if (currentPrice && (isNaN(currentPrice) || parseFloat(currentPrice) <= 0)) {
                showAlert('Ë´ãËº∏ÂÖ•ÊúâÊïàÁöÑËÇ°ÂÉπ', 'warning');
                return false;
            }
            return true;
        }
        
        document.getElementById('stockCode').addEventListener('blur', validateInputs);
        document.getElementById('currentPrice').addEventListener('blur', validateInputs);
    </script>
</body>
</html>
